<!--
 * @Author: JohnJeep
 * @Date: 2019-09-20 15:05:29
 * @LastEditTime: 2021-08-21 22:27:06
 * @LastEditors: Windows10
 * @Description: 深入理解指针
--> 

<!-- TOC -->
# Table of Contents

- [1. 概念](#1-%E6%A6%82%E5%BF%B5)
- [2. 定义](#2-%E5%AE%9A%E4%B9%89)
- [3. 指针关键注意点](#3-%E6%8C%87%E9%92%88%E5%85%B3%E9%94%AE%E6%B3%A8%E6%84%8F%E7%82%B9)
- [4. 应用](#4-%E5%BA%94%E7%94%A8)
- [5. 野指针](#5-%E9%87%8E%E6%8C%87%E9%92%88)
- [6. 零值指针和 NULL 指针的区别](#6-%E9%9B%B6%E5%80%BC%E6%8C%87%E9%92%88%E5%92%8C-null-%E6%8C%87%E9%92%88%E7%9A%84%E5%8C%BA%E5%88%AB)
- [7. 参考](#7-%E5%8F%82%E8%80%83)

<!-- /TOC -->

# 1. 概念
- 地址：一片内存中，每个字节（Byte）的编号
- `地址，字节，位`他们在内存中的关系：
    > 内存是一栋大楼，字节（Byte）是大楼中的每一层，地址是楼层编号，位（bit）是每一层中的房间，每一层有8个房间。
- 变量内存：在内存中申请一块空间，该空间由多个字节组成
- 指针：是一种数据类型，是指它指向的内存空间的数据类型。（程序数据在内存中的地址）。在c语言当中，允许用一个变量来存放指针，这种变量称为指针变量。
- 不管是什么类型的指针变量，所存的值都是地址（int类型的值）。那么声明不同类型的作用是什么？
  > 答案：通过声明指针类型，告诉指针每次移动多少字节，来获取变量的值。


# 2. 定义
- 指针定义：` 数据类型 *指针变量名; `
  - 符号` * `是定义指针变量的标志， 不是变量名的一部分
  - 表示指针变量指向的数据类型。例如：`int *P` 表示指针变量指向int的数据类型
  - `指针变量名`：表示指向另一个数据地址的变量，本质是一个地址变量。
  - `*指针变量名`：表示指向另一个数据地址里面的值，本质是一个数据值变量。
  - ` * `：取内容运算符；取出指针变量所指向地址的内容
  - ` & `：取地址运算符；获取变量在计算机内存中的存储地址。取地址运算符的操作对象（变量）一定是定义过的变量或数组元素。 
 

# 3. 指针关键注意点
- 定义指针时，编译器并不为指针所指向的对象分配空间，它只是分配指针本身的空间，除非在定义时同时赋值给指针一个字符串常量进行初始化。
- 定义时不能为常量分配空间。例如：`float *p = 3.14;` 会导致编译不通过。
- 保存数据的地址，任何存入指针变量p 的数据都会被当作地址来处理。 p 本身的地址由编译器另外存储，存储在哪里，我们并不知道。
- `*` 放在 `=` 的左边，给内存赋值，读内存；`int *p = 10;`
- `*` 放在 `=` 的右边，取内存的值，往内存写；`int q = *p;`
- 指针变量与它指向的内存块是两个不同的概念
- 不允许向NULL和非法地址拷贝内存。
  - `char *p = NULL; strcpy(p, "abcdef");`  会出错，空指针p不指向任何对象或函数。
  - `char *p = 0x1234; strcpy(p, "abcdef");` 也出错，指针p没有指向一个内存地址。
- 向内存中写数据时，要保证指针所指向的内存块能修改。
  - `char buf[] = "abcdef"; buf[2] = 2;` 可以修改buf[2]的值，数组中的一般变量存放在内存的栈区。
  - `char *buf = "abcdef"; buf[2] = 2;` 不可以修改，*buf定义的变量存放在数据区。
- 空指针：定义一个指针变量后，没有指向一个确定的值。
  - 例如：`int* p=NULL;` 指针p为一个空指针。
  - C语言中使用宏NULL表示空指针常量：`#define  NULL  ((void *)0)`
  - 系统保证空指针不指向任何对象或函数。
- 初始化：` 数据类型 *指针变量名=内存地址； ` 
  - “内存地址”是地址常量或对变量取地址的运算表达式。 
  

# 4. 应用
- 指针为形参，作为函数的参数，给变量间接赋值。（实际中应用很多）
- 通过形参来改变实参的内容，必须地址传递

# 5. 野指针
- 什么是野指针？
  >野指针不是 NULL指针，它是随机即指向一块内存的指针。

  
- 产生的原因？
  - 野指针指向了一块没有访问权限的内存。（即指针没有初始化）
  - 指针p被free或者delete之后，没有置为NULL。
  - 指针操作超越了变量的作用范围。


- 如何避免野指针？
  - 将指针初始化为NULL。 
  - 用已有合法的可访问的内存地址对指针初始化
    ```c
    char num[ 30] = {0};
    char *p = num;
    ```
  - 使用malloc分配内存。（在堆空间内分配）分配后要进行检查是否分配成功，最后要进行释放内存。malloc函数分配完内存后需注意：
    - 检查是否分配成功（若分配成功，返回内存的首地址；分配不成功，返回NULL。可以通过if语句来判断）
    - 清空内存中的数据（malloc分配的空间里可能存在垃圾值，用memset或bzero 函数清空内存）     


# 6. 零值指针和 NULL 指针的区别

- 零值指针，是值为 0 的指针，可以是任何一种指针类型，可以是通用变体类型 void* 也可以是 char*，int*等。
- 空指针，其实空指针只是一种编程概念，就如一个容器可能有空和非空两种基本状态，而在非空时可能里面存储了一个数值是 0，因此空指针是人为认为的指针不提供任何地址讯息。


# 7. 参考
- [关于指针类型和指针类型转换的理解](https://www.cnblogs.com/chanabi/p/9228998.html)
- [C语言再学习 -- 再论数组和指针](https://blog.csdn.net/qq_29350001/article/details/54599196)
- [NULL指针、零指针、野指针](http://www.cnblogs.com/fly1988happy/archive/2012/04/16/2452021.html)