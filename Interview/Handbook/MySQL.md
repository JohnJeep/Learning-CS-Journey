<!--
 * @Author: JohnJeep
 * @Date: 2021-04-08 21:39:42
 * @LastEditTime: 2025-11-17 09:17:33
 * @LastEditors: JohnJeep
 * @Description: MySQL 面试题
-->

<!-- TOC -->

- [1. MySQL](#1-mysql)
  - [1.1. 述一下MySQL的索引](#11-述一下mysql的索引)
  - [1.2. 讲B树 、B+树、聚簇索引和非聚簇索引](#12-讲b树-b树聚簇索引和非聚簇索引)
  - [1.3. MySQL索引优化，分析某条SQL语句走了那些索引（explain)](#13-mysql索引优化分析某条sql语句走了那些索引explain)
  - [1.4. MySQL行锁和表锁](#14-mysql行锁和表锁)
  - [1.5. 数据库的分库分表操作，或者MySQL的主从复制。](#15-数据库的分库分表操作或者mysql的主从复制)
  - [1.6. Redis底层数据结构](#16-redis底层数据结构)
  - [1.7. 跳跃表的实现](#17-跳跃表的实现)
  - [1.8. Redis的持久化策略AOF和RDB](#18-redis的持久化策略aof和rdb)
  - [1.9. Redis的缓存穿透](#19-redis的缓存穿透)
  - [1.10. 缓存雪崩](#110-缓存雪崩)
  - [1.11. Redis的主从复制原理 和 Redis的哨兵原理](#111-redis的主从复制原理-和redis的哨兵原理)
  - [1.12. Redis的一致性Hash问题](#112-redis的一致性hash问题)
  - [1.13. 高并发环境下，先操作数据库还是先删除缓存？](#113-高并发环境下先操作数据库还是先删除缓存)
  - [1.14. 在Redis主备切换时的数据丢失问题，异步复制和集群脑裂](#114-在redis主备切换时的数据丢失问题异步复制和集群脑裂)
- [2. Redis](#2-redis)
  - [2.1. 五种数据结构](#21-五种数据结构)
  - [2.2. 底层模型](#22-底层模型)
  - [2.3. 缓存击穿](#23-缓存击穿)
  - [2.4. 缓存雪崩](#24-缓存雪崩)

<!-- /TOC -->


# 1. MySQL
## 1.1. 述一下MySQL的索引
## 1.2. 讲B树 、B+树、聚簇索引和非聚簇索引
## 1.3. MySQL索引优化，分析某条SQL语句走了那些索引（explain)
## 1.4. MySQL行锁和表锁
## 1.5. 数据库的分库分表操作，或者MySQL的主从复制。
## 1.6. Redis底层数据结构
## 1.7. 跳跃表的实现
## 1.8. Redis的持久化策略AOF和RDB
## 1.9. Redis的缓存穿透
## 1.10. 缓存雪崩
## 1.11. Redis的主从复制原理 和 Redis的哨兵原理
## 1.12. Redis的一致性Hash问题
## 1.13. 高并发环境下，先操作数据库还是先删除缓存？
## 1.14. 在Redis主备切换时的数据丢失问题，异步复制和集群脑裂


Bilibili2020年最新阿里数据库索引面试题，1小时精通MySQL索引底层原理！
MySQL GROUP BY 分组的问题


问题1：MySQL中存储索引用到的数据结构是B+树，B+树的查询时间跟树的高度有关，是log(n)，如果用hash存储，那么查询时间是O(1)。既然hash比B+树更快，为什么mysql用B+树来存储索引呢？
	• 答：一、从内存角度上说，数据库中的索引一般时在磁盘上，数据量大的情况可能无法一次性装入内存，B+树的设计可以允许数据分批加载。
	• 二、从业务场景上说，如果只选择一个数据那确实是hash更快，但是数据库中经常会选中多条这时候由于B+树索引有序，并且又有链表相连，它的查询效率比hash就快很多了。
		
问题2：为什么不用红黑树或者二叉排序树？
	• 答：树的查询时间跟树的高度有关，B+树是一棵多路搜索树可以降低树的高度，提高查找效率

问题3：既然增加树的路数可以降低树的高度，那么无限增加树的路数是不是可以有最优的查找效率？
	• 答：这样会形成一个有序数组，文件系统和数据库的索引都是存在硬盘上的，并且如果数据量大的话，不一定能一次性加载到内存中。有序数组没法一次性加载进内存，这时候B+树的多路存储威力就出来了，可以每次加载B+树的一个结点，然后一步步往下找。

问题4：在内存中，红黑树比B树更优，但是涉及到磁盘操作B树就更优了，那么你能讲讲B+树吗？
	• 答：B+树是在B树的基础上进行改造，它的数据都在叶子结点，同时叶子结点之间还加了指针形成链表。下面是一个4路B+树，它的数据都在叶子结点，并且有链表相连。
		

	• 问题5：为什么B+树要这样设计？
		○ 答：这个跟它的使用场景有关，B+树在数据库的索引中用得比较多，数据库中select数据，不一定只选一条，很多时候会选中多条，比如按照id进行排序后选100条。如果是多条的话，B+树需要做局部的中序遍历，可能要跨层访问。而B+树由于所有数据都在叶子结点不用跨层，同时由于有链表结构，只需要找到首尾，通过链表就能把所有数据取出来了。比如选出7到19只需要在叶子结点中就能找到。
		

数据库索引为什么要用 B+ 树而不用红黑树呢？
AVL 数和红黑树基本都是存储在内存中才会使用的数据结构，那磁盘中会有什么不同呢？
这就要牵扯到磁盘的存储原理了。操作系统读写磁盘的基本单位是扇区，而文件系统的基本单位是(Cluster)。也就是说，磁盘读写有一个最少内容的限制，即使我们只需要这个簇上的一个字节的内容，我们也要把一整个簇上的内容读完。那么，现在问题就来了，一个父节点只有 2 个子节点，并不能填满一个簇上的所有内容啊？那多余的内容岂不是要浪费了？我们怎么才能把浪费的这部分内容利用起来呢？，答案就是 B+ 树。
由于 B+ 树分支比二叉树更多，所以相同数量的内容，B+ 树的深度更浅，深度代表什么？代表磁盘 io 次数！数据库设计的时候 B+ 树有多少个分支都是按照磁盘一个簇上最多能放多少节点设计的啊！所以，涉及到磁盘上查询的数据结构，一般都用 B+ 树。

作者：_晴雨天
链接：https://www.jianshu.com/p/3af3c59f59bc

分库分表、索引
LRU缓存淘汰机制

# 2. Redis
## 2.1. 五种数据结构
## 2.2. 底层模型
## 2.3. 缓存击穿
## 2.4. 缓存雪崩


